<the full code from previous cell, re-inserted here>